<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Encodage pour les accents -->
        <meta charset="UTF-8">
        
        <!-- Titre de la Page -->
        <title>Javascript | Multiples Formulaires</title>

        <!-- Pour Internet Explorer : S'assurer qu'il utilise la dernière version du moteur de rendu -->
        <meta http-equiv="X-UA-Compatible" content="ie=edge">

        <!-- Affichage sans zoom pour les mobiles -->
        <meta name="viewport" content="width=device-width, init-scale=1">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- Styles CSS -->
        <link rel="stylesheet" href="./assets/css/style.css">

        <!--  Font Awesome | Icons -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

        <!-- HTML5 Shiv & Respond JS -->
        <!--[if lt IE 9]>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
        <![endif]-->
    </head>

    <body>
        <main>
            <h1>Inscription</h1>
            <div class="progress barreProgression">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 25%"></div>
            </div>

            <h2>Identité</h2>

            <form action="machin.php" id="myForm">
                <div class="col-xs-12 current">
                    <input type="text" placeholder="Prenom" id="prenom">
                </div>

                <div class="col-xs-12">
                    <input type="text" placeholder="Email" id="email">
                </div>

                <div class="col-xs-12">
                    <input type="text" placeholder="Telephone" id="tel">
                </div>

                <div class="col-xs-12">
                    <input type="text" placeholder="Pseudo" id="pseudo">
                </div>

                <div class="col-xs-12">
                    <input type="passeword" placeholder="Mot de Passe" id="mdp">
                </div>
                
                <div class="col-xs-12 current">
                    <input type="submit" id="submit" value="Envoyer !">
                </div>

            </form>
        </main>


        <!-- jQuery CDN -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

        <!-- Bootstrap JS -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>        


        <script>

            /* --------------------------- CONSIGNES -------------------------------

            ||||||    1)  Traiter les erreurs : champs manquants, bordures    ||||||
            ||||||  rouges, notifications (avec animation si possible)        ||||||
            ||||||                                                            ||||||
            ||||||    2)  Afficher / cacher les inputs après un submit        ||||||
            ||||||                                                            ||||||
            ||||||    3)  Envoyer les données dans le tableau et l'afficher   ||||||
            ||||||  avec des <ul> et <li>                                     ||||||

            --------------------------------------------------------------------- */

            var contacts = [
                    {prenom: 'Etienne de Bazelaire de Ruppierre', email:'e.debaze@gmail.com', tel:'0623132875', pseudo: 'Etienne', mdp: 'azerty'},
                    {prenom: 'Jesus de Nazareth', email:'j.denazar@gmail.com', tel:'0731254869', pseudo: 'Jesus', mdp: 'azerty'},
                    {prenom: 'Marc Harrington', email:'m.harrington@gmail.com', tel:'0658974521', pseudo: 'Marc', mdp: 'azerty'},
                    {prenom: 'Benjamin Barns', email:'b.barns@gmail.com', tel:'0623214547', pseudo: 'Benjamin', mdp: 'azerty'},
                    {prenom: 'Adrien Scout', email:'a.scout@gmail.com', tel:'0698725461', pseudo: 'Adrien', mdp: 'azerty'},
                ]

        </script>
        

        <script>
            var test = 0;
            $(function() {


                $('#myForm').submit(function(e) {
                    // On empeche le formulaire de s'envoyer
                    e.preventDefault()

                    // On récupère les variables
                    prenom = $('#prenom')
                    email = $('#email')
                    tel = $('#tel')
                    pseudo = $('#pseudo')
                    mdp = $('#mdp') 


                    // On vérifie ces informations

                    // Test du pseudo et du mdp
                    if(test == 2 && (pseudo.val() == "" || mdp.val() == "")) {
                        // On affiche la notification d'erreur
                        $('main').append('<div class="alert alert-danger" style="width: 50%; margin-left:25%; float:left;" role="alert"> Vous devez remplir ce champ </div>')
                        $('.alert-danger').delay(2000).hide(1500)
                    } else if (test == 2){
                        // On clean le main et on affiche la notification de succés
                        $('main').empty().append('<div class="alert alert-success" style="width: 50%; margin-left:25%; float:left;" role="alert"> Vous êtes désormais inscrit </div>')

                        // On ajoute les informations dans le tableau
                        contacts.push({prenom: prenom.val(), email: email.val(), tel: tel.val(), pseudo: pseudo.val(), mdp: mdp.val()})

                        // On crée une boucle pour parcourir le tableau
                        for(let i=0; i<contacts.length ; i++) {
                            // On affiche le tableau dans le main
                            $('main').append('<br><br><ul style="clear: both"><li style:"list-style-type: none">' + contacts[i].prenom + '</li><li>' + contacts[i].email + '</li><li>' + contacts[i].tel + '</li><li>' + contacts[i].pseudo + '</li><li>' + contacts[i].mdp +'</li></ul>')
                        }
                    }
                    



                    // Test du mail et du telephone
                    if(prenom.val() != "" && test == 1 && (email.val() == "" || tel.val() == "")) {
                        // On affiche la notification d'erreur
                        $('main').append('<div class="alert alert-danger" style="width: 50%; margin-left:25%; float:left;" role="alert"> Vous devez remplir ce champ </div>')
                        
                        // On fait disparaitre cette notification au bout de 2 secondes
                        $('.alert-danger').delay(2000).hide(1500)

                    } else if (test == 1) {
                        // On modifie la taille de la barre de chargement
                        $('.progress-bar').css({width: '100%'})

                        // On enlève la classe "current" sur le mail et le tel
                        email.parent().removeClass('current')
                        tel.parent().removeClass('current')

                        // On affiche les autres input
                        pseudo.parent().addClass('current')
                        mdp.parent().addClass('current')

                        // Incrémentation de test
                        test ++
                    }




                    // Test du prenom
                    if(prenom.val() == "" && test == 0) {
                        // On affiche la notification d'erreur
                        $('main').append('<div class="alert alert-danger" style="width: 50%; margin-left:25%; float:left;" role="alert"> Vous devez rentrer un prénom </div>')
                        $('.alert-danger').delay(2000).hide(1500)

                    } else if (test == 0) {
                        // On modifie la taille de la barre de chargement
                        $('.progress-bar').css({width: '50%'})

                        // On enlève la classe "current" sur prenom
                        prenom.parent().removeClass('current')

                        // On affiche les autres input
                        email.parent().addClass('current')
                        tel.parent().addClass('current')

                        // Incrémentation de test 
                        test ++
                    }

                    
                })
            })
        </script>
    </body>
</html>